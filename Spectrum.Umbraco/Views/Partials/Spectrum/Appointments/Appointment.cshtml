@using Spectrum.Content.Appointments.ViewModels
@model AppointmentViewModel

<table class="table table-striped table-bordered">
    <tbody>
    <tr>
        <td>Appointment Id</td>
        <td>@Model.Id</td>
    </tr>
    <tr>
        <td>Created Time</td>
        <td>@Model.CreatedTime.ToString("ddd dd MMM HH:mm")</td>
    </tr>
    <tr>
        <td>Created By</td>
        <td>@Model.CreatedUser</td>
    </tr>
    <tr>
        <td>Last Updated Time</td>
        <td>@Model.LastUpdatedTime.ToString("ddd dd MMM HH:mm")</td>
    </tr>
    <tr>
        <td>Last Updated By</td>
        <td>@Model.LastedUpdatedUser</td>
    </tr>
    <tr>
        <td>Start Time</td>
        <td>@Model.StartTime.ToString("ddd dd MMM HH:mm")</td>
    </tr>
    <tr>
        <td>End Time</td>
        <td>@Model.EndTime.ToString("ddd dd MMM HH:mm")</td>
    </tr>
    <tr>
        <td>Duration (In Minutes)</td>
        <td>@Model.Duration</td>
    </tr>
    <tr>
        <td>Payment Id</td>
        <td>@Model.PaymentId</td>
    </tr>
    <tr>
        <td>Location</td>
        <td>@Model.Location</td>
    </tr>
    <tr>
        <td>Description</td>
        <td>@Model.Description</td>
    </tr>
    
    <tr>
        <td colspan='2'>Attendees</td>
    </tr>
        
    @foreach (var item in Model.Attendees)
    {
        <tr><td>@item</td></tr>
    }

    <tr align="center">
        <td colspan='2'>
            <a href="@Model.UpdateAppointmentUrl">Update Appointment</a> |
            <a href="@Model.DeleteAppointmentUrl" id="deleteAppointment">Delete Appointment</a>
        </td>
    </tr>

    </tbody>
</table>

<script type="text/javascript">

    $(document).ready(function () {

        $('#deleteAppointment').click(function () {
            event.preventDefault();

            confirm("Confirm you want to delete this apppointment",
                function () {
                    var href = $('#deleteAppointment').attr('href');

                    $.ajax({
                        url: href,
                        success: function (data) {
                            window.location.href = data;
                        }
                    });
                });
        });
    });

    //// TODO : move to an external js file for reuse?
    window.confirm = function (message, callback, caption) {
        caption = caption || 'Confirmation';
        $(document.createElement('div')).attr({
            title: caption,
            'class': 'dialog'
        }).html(message).dialog({
            dialogClass: 'fixed',
            buttons: {
                "OK": function () {
                    $(this).dialog('close');
                    callback();
                    return true;
                },
                "Cancel": function () {
                    $(this).dialog('close');
                    return false;
                }
            },
            close: function () {
                $(this).remove();
            },
            draggable: false,
            modal: true,
            resizable: false,
            width: 'auto'
        });
    };

</script>
