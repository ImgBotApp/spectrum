@using Spectrum.Content.Customer.Controllers
@using Spectrum.Content.Customer.ViewModels
@model AddressSearchViewModel
@{
    Html.EnableClientValidation(true);
    Html.EnableUnobtrusiveJavaScript(true);
}

@using (Html.BeginUmbracoForm<SearchController>("GetAddresses"))
{
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)

        <div class="center-content">
            <div class="row">
                <div class="col-sm-6 col-md-4 col-md-offset-4">
                    <div class="account-wall">

                        @Html.EditorFor(model => model.BuildingNumber, new { htmlAttributes = new { @class = "form-control buildingNumber", placeholder = "Building No" } })
                        @Html.ValidationMessageFor(model => model.BuildingNumber)

                        @Html.EditorFor(model => model.PostCode, new { htmlAttributes = new { @class = "form-control postCode", placeholder = "Post Code" } })
                        @Html.ValidationMessageFor(model => model.PostCode)

                        <button id="findAddress" class="btn btn-secondary">Find Address</button>
                    </div>
                </div>
            </div>
        </div>
        
        <script>

        $(document).ready(function () {

            $('form').submit(function (event) {
                $('#findAddress').prop('disabled', true);
                $('#findAddress').text('Searching...');
                event.preventDefault();
                alert("hello");

                var url = "/umbraco/Surface/Search/GetAddresses";

                var postData = {
                    buildingNumber: "12",
                    postCode: "NG5 4DB"
                };

                $.ajax({
                    url: url,
                    type: 'POST',
                    dataType: 'json',
                    data: JSON.stringify(postData),
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        console.log('Server success ' + data);
                        $('#findAddress').prop('disabled', false);
                        $('#findAddress').text('Find Address...');
                        
                    },
                    error: function (request, status, errorThrown) {
                        console.log('Server error ' + errorThrown);
                        window.location.href = "/error";
                    }
                });
            });
        });

        </script>
}

